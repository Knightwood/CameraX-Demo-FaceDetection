{"config":{"lang":["en","zh"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u57fa\u672c\u4f7f\u7528","text":"<p>\u76ee\u524d\u53ef\u4ee5\u76f4\u63a5\u76f4\u63a5\u5f15\u5165\uff0c\u540e\u7eed\u4f1a\u6784\u5efa\u51faaar\u5305\u65b9\u4fbf\u4f7f\u7528\u3002 \u6b64\u5b58\u50a8\u5e93\u6709\u5982\u4e0b\u6a21\u5757</p> <pre><code>include(\":app\") // \u793a\u4f8b\ninclude(\":camerax_lib\")// \u76f8\u673a\u5e93\uff0c\u5b9e\u73b0\u62cd\u7167\uff0c\u5f55\u50cf\uff0c\u56fe\u50cf\u5206\u6790\u63a5\u53e3\u7b49\ninclude(\":compose_camerax\") // compose\u7248\u76f8\u673a\u5e93\ninclude(\":camerax_analyzer_mlkit\") // \u96c6\u6210mlkit\uff0c\u7ed8\u5236\u4eba\u8138\u5750\u6807\uff0c\u5206\u6790\u4eae\u5ea6\u7b49\ninclude(\":camerax_analyzer_tensorflow\") // \u96c6\u6210TensorFlowList\uff0c\u4f7f\u7528tflite\u6a21\u578b\u8fd0\u884c\u5206\u6790\n</code></pre> <p>\u5176\u4e2d\uff0c<code>camerax_analyzer</code>\u548c<code>camerax_analyzer_tensorflow</code>\u90fd\u4f9d\u8d56<code>camerax_lib</code> module\u3002 <code>compose_camerax</code> module\u8fd8\u672a\u8fdb\u884c\u5f00\u53d1\u3002</p> <p>\u4f7f\u7528\uff1a</p> <ol> <li>\u514b\u9686\u4ee3\u7801\u5230\u672c\u5730 <pre><code>  git clone git@github.com:Knightwood/CameraX-Helper.git\n</code></pre></li> <li>\u5f15\u5165\u4f9d\u8d56    \u5728AndroidStudio\u4e2d\uff0cFile-&gt;New-&gt;Import Module\u2026    \u5c06<code>camerax_lib</code>\u3001<code>camerax_analyzer_mlkit</code>\u3001<code>camerax_analyzer_tensorflow</code>\u4e09\u4e2amodule\u5bfc\u5165\u5230\u9879\u76ee\u4e2d\u3002    \u5982\u679c\u4e0d\u9700\u8981mlkit\u6216tensorflow\uff0c\u53ef\u4ee5\u4e0d\u5bfc\u5165<code>camerax_analyzer</code>\u3001<code>camerax_analyzer_tensorflow</code> \u8fd9\u4e24\u4e2amodule\u3002</li> </ol> <p>\u590d\u5236\u9879\u76ee\u7684build.gradle.kts\u6587\u4ef6\u4e2d\u7684ext    <pre><code> ext {\n     this[\"version\"] = \"1.3.1\"\n     this[\"abi\"] = listOf(\"arm64-v8a\") //listOf(\"armeabi\", \"armeabi-v7a\", \"arm64-v8a\")\n }\n</code></pre></p> <ol> <li>app module\u7684build.gradle\u6587\u4ef6\u6dfb\u52a0\u4f9d\u8d56 <pre><code>dependencies {\n    implementation(project(\":camerax_lib_mlkit\"))\n    implementation(project(\":camerax_analyzer_mlkit\")) //\u53ef\u9009\n    implementation(project(\":camerax_analyzer_tensorflow\")) //\u53ef\u9009\n}\n</code></pre></li> </ol>"},{"location":"#_2","title":"\u5c4f\u5e55\u65b9\u5411\u53ca\u9500\u6bc1\u91cd\u5efa","text":"<p>\u5bf9\u4e8e\u5c4f\u5e55\u65b9\u5411\uff0c\u672c\u5e93\u5185\u90e8\u5df2\u7ecf\u5b9e\u73b0\u4e86\u6839\u636e\u5f53\u524d\u624b\u673a\u5c4f\u5e55\u65b9\u5411\u51b3\u5b9a\u62cd\u6444\u51fa\u6765\u56fe\u50cf\u7684\u65b9\u5411\u3002 \u5982\u679c\u4e0d\u56fa\u5b9a\u5c4f\u5e55\u65b9\u5411\uff0c\u5bf9\u4e8e\u76f8\u673a\u7684\u5e03\u5c40\u9875\u9762\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u5728\u7ad6\u5c4f\u548c\u6a2a\u5c4f\u4e0b\u4f7f\u7528\u4e0d\u540c\u7684\u5e03\u5c40\u3002 \u9664\u4e86\u5c4f\u5e55\u65b9\u5411\uff0c\u8fd8\u6709\u5728\u5c4f\u5e55\u65b9\u5411\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u76f8\u673a\u4e5f\u4f1a\u9500\u6bc1\u91cd\u5efa\uff0c\u4e3a\u4e86\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u6027\u80fd\u5f00\u9500\uff0c\u9700\u8981\u8bbe\u7f6e\u4e00\u4e0b<code>configChanges</code> \uff0c\u4f7f\u5176\u4e0d\u4f1a\u53d1\u751f\u9500\u6bc1\u91cd\u5efa\u3002 \u5c4f\u5e55\u65b9\u5411\u76f8\u5173\u6587\u6863</p> <p>\u76f8\u673a\u672c\u8eab\u7684\u5750\u6807\u7cfb\u662f\u4e0e\u5c4f\u5e55\u4e0d\u540c\u7684\uff0c\u56fe\u50cf\u5206\u6790\u5f97\u5230\u7684\u5750\u6807\u503c\u9700\u8981\u7ecf\u8fc7\u8f6c\u6362\u624d\u53ef\u4ee5\u7ed8\u5236\u5230\u5c4f\u5e55\u4e0a\uff0c\u5426\u5219\u4f1a\u6709\u504f\u5dee\u3002 \u5750\u6807\u8f6c\u6362\u76f8\u5173\u6587\u6863</p> <ol> <li>\u5c4f\u5e55\u65b9\u5411\u914d\u7f6e\uff0c\u4f8b\u5982\u56fa\u5b9a\u7ad6\u5c4f\u3001\u6a2a\u5c4f\u3001\u4e0d\u8bbe\u7f6e\u7b49\u3002 <pre><code>&lt;activity android:screenOrientation=\"portrait\" /&gt;\n</code></pre></li> <li>\u5c4f\u5e55\u65cb\u8f6c\u4f1a\u6d89\u53ca\u5230\u8d44\u6e90\u7684\u9500\u6bc1\u91cd\u5efa\uff0c\u5982\u679c\u4e0a\u4e00\u6b65\u9009\u62e9\u4e0d\u56fa\u5b9a\u5c4f\u5e55\u65b9\u5411\uff0c\u6700\u597d\u8bbe\u7f6e\u4e00\u4e0b<code>configChanges</code>. <pre><code>&lt;activity android:configChanges=\"orientation|screenSize\" /&gt;\n</code></pre></li> </ol>"},{"location":"#_3","title":"\u793a\u4f8b\u76f8\u673a","text":"<p><code>app</code> module\u4e0b\u7684<code>CameraExampleActivity</code>\u548c<code>CameraExampleActivity2</code> \u5219\u662f\u4e24\u4e2a\u793a\u4f8b\uff0c\u5206\u522b\u4f7f\u7528\u4e86<code>BaseCameraXActivity</code>\u548c<code>BaseCameraXFragment</code>\u5b9e\u73b0\u76f8\u673a\uff0c\u4f60\u53ef\u4ee5\u5c06\u4ed6\u4eec\u590d\u5236\u5230\u4f60\u7684\u9879\u76ee\u4e2d\u4f7f\u7528 \u5982\u4f55\u8fdb\u884c\u76f8\u673a\u914d\u7f6e\uff0c\u5728\u8fd9\u4e24\u4e2a\u5b9e\u4f8b\u4e2d\u4e5f\u6709\u8db3\u591f\u7684\u89e3\u91ca\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u66f4\u8fdb\u4e00\u6b65\u7684\u9700\u6c42\uff0c\u53ea\u77e5\u9053\u8fd9\u56db\u4e2a\u65b9\u6cd5\u8db3\u591f\u4e86\u3002\u5373\u4f7f\u4e0d\u8fdb\u884c\u5b58\u50a8\u65b9\u9762\u7684\u914d\u7f6e\uff0c\u4e5f\u4f1a\u6b63\u5e38\u8fd0\u884c\uff0c\u4f1a\u81ea\u52a8\u5b58\u5165\u76f8\u518c\u6587\u4ef6\u5939\u3002</p> \u51fd\u6570 \u63cf\u8ff0 cameraHolderInitStart \u8fd9\u4e2a\u4f1a\u5728\u76f8\u673a\u521d\u59cb\u5316\u4e4b\u524d\u88ab\u8c03\u7528 cameraHolderInitFinish \u8fd9\u4e2a\u4f1a\u5728\u76f8\u673a\u521d\u59cb\u5316\u4e4b\u540e\u88ab\u8c03\u7528 onPhotoTaken \u7167\u7247\u62cd\u6444\u5b8c\u6210 onVideoRecorded \u89c6\u9891\u5f55\u5236\u5b8c\u6210 <p>\u540c\u65f6\u5462\uff0c\u5982\u679c\u7ed9\u76f8\u673a\u914d\u7f6e\u56fe\u50cf\u5206\u6790\uff0c\u5219\u9700\u8981\u5728<code>cameraHolderInitStart</code>\u4e2d\u914d\u7f6e\u3002 <pre><code>    /** \u62cd\u5b8c\u7167\u7247 */\n    override fun onPhotoTaken(saveFileData: SaveFileData?) {\n        super.onPhotoTaken(saveFileData)\n        Log.d(\"CameraXFragment\", \"onPhotoTaken\uff1a $saveFileData\")\n        cameraXF.indicateTakePhoto()//\u62cd\u7167\u95ea\u5149\n    }\n\n    /** \u5f55\u5b8c\u89c6\u9891 */\n    override fun onVideoRecorded(saveFileData: SaveFileData?) {\n        super.onVideoRecorded(saveFileData)\n        saveFileData?.let {\n            Log.d(TAG, \"onVideoRecorded: $it\")\n        }\n    }\n\n     //FaceContourDetectionProcessor\u662fImageAnalysis.Analyzer\u7684\u5b9e\u73b0\n     var analyzer: FaceContourDetectionProcessor? = null\n\n    /**\n     * Camera holder init start\n     * \u6b64\u51fd\u6570\u4f1a\u5728\u76f8\u673a\u521d\u59cb\u5316\u4e4b\u524d\u56de\u8c03\uff0c\u6240\u4ee5\u9002\u5408\u5728\u8fd9\u91cc\u521d\u59cb\u5316\u56fe\u50cf\u5206\u6790\n     *\n     * @param cameraHolder\n     */\n    override fun cameraHolderInitStart(cameraHolder: CameraHolder) {\n        super.cameraHolderInitStart(cameraHolder)\n        val cameraPreview = cameraHolder.cameraPreview\n\n        //\u793a\u4f8b1\n        //\u751f\u6210\u56fe\u50cf\u5206\u6790\u5668\n        analyzer = FaceContourDetectionProcessor(\n            cameraPreview,\n            findViewById&lt;GraphicOverlayView&gt;(R.id.graphicOverlay_finder),\n        )\n        setUpAnalyzer(analyzer)//\u8bbe\u7f6e\u5206\u6790\u5668\n        //\u76d1\u542c\u5206\u6790\u7ed3\u679c\n        (analyzer as FaceContourDetectionProcessor).analyzeListener =\n            AnalyzeResultListener {\n                // when analyze success\n            }\n\n        //\u793a\u4f8b2\n        //\u52a0\u8f7dtensorflow lite\u6a21\u578b\uff0c\u8fd9\u91cc\u4ec5\u505a\u6f14\u793a\n//        val model = FaceDetection.create(\n//            this.assets,\n//            TestFileDecActivity.TF_OD_API_MODEL_FILE,\n//            TestFileDecActivity.TF_OD_API_LABELS_FILE,\n//            TestFileDecActivity.TF_OD_API_IS_QUANTIZED\n//        )\n//        //TensorFlowLink\u7ee7\u627f\u81eaImageAnalysis.Analyzer\uff0c\u5c06\u5176\u4f5c\u4e3a\u5206\u6790\u5668\u8bbe\u7f6e\u7ed9\u76f8\u673a\u5373\u53ef\u62ff\u5230\u5206\u6790\u6d41\n//        val tensorFlowLink = TensorFlowLink {image: ImageProxy -&gt;\n//            //\u83b7\u53d6\u56fe\u50cf\n//            val bitmap= image.toBitmap()\n//            //\u8fd9\u91cc\u4f7f\u7528\u4e86mlkit\u5206\u6790\u662f\u5426\u5305\u542b\u9762\u90e8\u6570\u636e\uff0c\u5982\u679c\u5305\u542b\uff0c\u5219\u5c06\u9762\u90e8\u56fe\u50cf\u88c1\u526a\u4e0b\u6765\n//            MyFileProcessor.process(bitmap){\n//                it?.let {\n//                    //\u5c06\u88c1\u526a\u540e\u7684\u9762\u90e8\u56fe\u50cf\u8f6c\u6362\u6210\u7279\u5b9a\u5c3a\u5bf8bitmap\n//                    val tmp = FaceDetection.convertBitmap(it)\n//                    //\u5c06\u5904\u7406\u597d\u7684\u9762\u90e8\u56fe\u50cf\u4ea4\u7ed9\u6a21\u578b\u5904\u7406\uff0c\u83b7\u53d6\u7279\u5f81\u70b9\n//                    val masks = model.detectionBitmap(tmp)\n//                }\n//            }\n//\n//        }\n//        setUpAnalyzer(tensorFlowLink)//\u8bbe\u7f6e\u5206\u6790\u5668\n\n    }\n</code></pre> \u56fe\u7247</p>"},{"location":"#_4","title":"\u81ea\u5b9a\u4e49\u76f8\u673a","text":"<p>\u6700\u57fa\u7840\u7684\u76f8\u673a\u5b9e\u73b0\u7c7b\u662f<code>CameraXFragment</code> \uff0c\u5176\u5b9e\u73b0\u4e86\u6700\u57fa\u672c\u7684\u76f8\u673a\u9884\u89c8\uff0c\u5e76\u6301\u6709CameraHolder\uff0c\u5b9e\u73b0\u6240\u6709\u7684\u76f8\u673a\u529f\u80fd\u3002 <code>BaseCameraXActivity</code>\u5219\u6301\u6709<code>CameraXFragment</code> \uff0c\u5e76\u5b9e\u73b0\u4e86\u4e00\u4e2a\u57fa\u672c\u7684\u76f8\u673a\u754c\u9762\uff0c\u4f8b\u5982\u95ea\u5149\u706f\u3001\u70b9\u51fb\u5bf9\u7126\uff0c\u62cd\u7167\u3001\u5f55\u50cf\u7b49\u529f\u80fd\u3002 <code>BaseCameraXFragment</code>\u7ee7\u627f\u81ea<code>CameraXFragment</code>\uff0c\u5176\u4e0e<code>BaseCameraXActivity</code> \u4e00\u6837\uff0c\u5b9e\u73b0\u4e86\u57fa\u672c\u7684\u76f8\u673a\u754c\u9762\u548c\u529f\u80fd\u3002 \u56e0\u6b64\uff0c\u4f60\u53ef\u4ee5\u81ea\u884c\u9009\u62e9\u4f7f\u7528<code>BaseCameraXActivity</code>\u3001<code>BaseCameraXFragment</code>\u5b9e\u73b0\u76f8\u673a\u529f\u80fd\uff0c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528<code>CameraXFragment</code>\u5b9e\u73b0\u8fdb\u4e00\u6b65\u7684\u5b9a\u5236\u3002 \u5982\u679c<code>CameraXFragment</code>\u4e5f\u65e0\u6cd5\u6ee1\u8db3\u9700\u6c42\uff0c\u53ef\u4ee5\u53c2\u7167<code>CameraXFragment</code>\uff0c\u4f7f\u7528<code>CameraHolder</code>\u7c7b\u5b9e\u73b0\u66f4\u6df1\u5c42\u6b21\u7684\u5b9a\u5236\u3002</p>"},{"location":"#_5","title":"\u76f8\u673a\u914d\u7f6e","text":"<p>Note</p> <p>\u8be6\u7ec6\u5185\u5bb9\u8bf7\u70b9\u51fb\u67e5\u770b\u5de6\u4fa7\u76ee\u5f55\u83dc\u5355</p> <p>\u914d\u7f6e\u5206\u4e3a\u4e86\u76f8\u673a\u7684\u521d\u59cb\u5316\u914d\u7f6e\uff0c\u5b58\u50a8\u914d\u7f6e\u4e24\u90e8\u5206\u3002 \u5b58\u50a8\u65b9\u9762\u5df2\u9002\u914dAndroid10\u4ee5\u4e0a\uff0c\u4e14\u914d\u7f6e\u7b80\u5355\u3002</p> <ul> <li> <p>\u76f8\u673a\u7684\u521d\u59cb\u5316\u914d\u7f6e\u4e2d\u5305\u62ec\u4e86\u5982\u4e0b\u5185\u5bb9\uff1a   \u662f\u5426\u5f00\u542f\u95ea\u5149\u706f   \u542f\u52a8\u540e\u4f7f\u7528\u4f55\u79cd\u7528\u4f8b\uff0c\u4f8b\u5982\u542f\u52a8\u540e\u4f7f\u7528\u62cd\u7167\u3001\u5f55\u50cf\u6216\u662f\u56fe\u50cf\u5206\u6790\u7b49\u3002   \u62cd\u7167\u914d\u7f6e-&gt;\u4f8b\u5982\u662f\u5426\u6c34\u5e73\u7ffb\u8f6c\uff0c\u5782\u76f4\u7ffb\u8f6c\u3001\u4f4d\u7f6e\u4fe1\u606f\u3001\u56fe\u50cf\u8d28\u91cf\u3001\u662f\u5426\u4f7f\u7528\u96f6\u5feb\u95e8\u5ef6\u8fdf\u7b49   \u5f55\u5236\u914d\u7f6e-&gt;\u6587\u4ef6\u5c3a\u5bf8\u9650\u5236\uff0c\u62cd\u6444\u8d28\u91cf\u3001\u89c6\u9891\u7f16\u7801\u6bd4\u7279\u7387\u3001\u955c\u50cf\u8bbe\u7f6e\u7b49</p> </li> <li> <p>\u5b58\u50a8\u914d\u7f6e\u4e2d\u5305\u62ec\u4e86\u5982\u4e0b\u5185\u5bb9\uff1a   \u4f7f\u7528CameraXStoreConfig\u7c7b\u914d\u7f6e\u62cd\u6444\u548c\u5f55\u50cf\u7684\u5b58\u50a8\u4f4d\u7f6e\u548c\u5b58\u50a8\u65b9\u5f0f   \u4f8b\u5982\u5b58\u50a8\u5728\u516c\u5171\u76ee\u5f55\u3001\u5b58\u50a8\u5728\u79c1\u6709\u76ee\u5f55\u4e2d\u3001\u5176\u4ed6\u76ee\u5f55\u7b49\u3002     \u4f7f\u7528file api\u5b58\u50a8\uff0c\u4f7f\u7528saf\u5b58\u50a8\uff0c\u4f7f\u7528MediaStore\u5b58\u50a8  </p> </li> </ul>"},{"location":"CaptureButton/","title":"CameraButton","text":"<p>\u6b64\u6309\u94ae\u63a7\u4ef6\u7528\u4e8e\u62cd\u7167\u548c\u5f55\u50cf\uff0c\u652f\u6301\u70b9\u51fb\u62cd\u7167\uff0c\u70b9\u51fb\u5f55\u50cf\u548c\u957f\u6309\u5f55\u50cf\uff0c\u957f\u6309\u5f55\u5236\u6709\u52a8\u753b</p> <p>\u652f\u6301\u8bbe\u7f6e\u5f55\u5236\u65f6\u957f\uff0c\u5230\u8fbe\u5f55\u5236\u65f6\u957f\u540e\u56de\u8c03\u901a\u77e5\u7ed3\u675f\u5f55\u5236\u3002</p> <p>\u53ef\u4ee5\u8bbe\u7f6e\u6309\u94ae\u4ec5\u652f\u6301\u62cd\u7167\uff0c\u4ec5\u652f\u6301\u5f55\u5236\uff0c\u6216\u90fd\u652f\u6301</p> <ol> <li>\u5728\u5f00\u542f\u957f\u6309\u5f55\u5236\u65f6\uff0c\u70b9\u51fb\u5f55\u5236\u5c06\u4e0d\u53ef\u7528</li> <li>\u5f00\u542f\u70b9\u51fb\u5f55\u5236\u65f6\uff0c\u62cd\u7167\u4e0d\u53ef\u7528</li> </ol> <p>\u5e03\u5c40\u6587\u4ef6\u793a\u4f8b</p> <pre><code>&lt;com.kiylx.camerax_lib.main.buttons.CameraButton\n    android:id=\"@+id/full_capture_btn\"\n    android:layout_width=\"wrap_content\"\n    android:layout_height=\"wrap_content\"\n    app:layout_constraintBottom_toBottomOf=\"parent\"\n    app:layout_constraintLeft_toLeftOf=\"parent\"\n    app:layout_constraintRight_toRightOf=\"parent\"\n    app:buttonMode=\"both\" //\u6307\u5b9a\u53ef\u62cd\u7167\uff0c\u53ef\u5f55\u5236\n    app:longPassRecord=\"true\" //\u5f00\u542f\u957f\u6309\u5f55\u5236\n    app:layout_constraintTop_toTopOf=\"parent\"\n    app:size=\"80\" /&gt;\n\n    \u5c5e\u6027\uff1a\n    buttonMode \u53ef\u9009\u503c\uff1aonly_capture\uff0conly_record\uff0cboth\n    maxDuration \u79d2\n    longPassRecord \u662f\u5426\u53ef\u957f\u6309\u5f55\u5236\n</code></pre> <p>\u4f7f\u7528\u793a\u4f8b</p> <pre><code>page.fullCaptureBtn.setCaptureListener(object : DefaultCaptureListener(){\n    //\u62cd\u7167\n    override fun takePictures() {\n        cameraXF.takePhoto()\n    }\n    //\u5f00\u59cb\u5f55\u5236\u89c6\u9891\n    override fun recordStart() {\n        page.captureVideoBtn.visibility = View.GONE\n        LogUtils.dTag(\"\u5f55\u5236activity\", \"\u5f00\u59cb\")\n        cameraXF.startRecord()\n        //\u5f55\u5236\u89c6\u9891\u65f6\u9690\u85cf\u6444\u50cf\u5934\u5207\u6362\n        page.switchBtn.visibility=View.GONE\n    }\n\n    //1. \u5f55\u5236\u89c6\u9891\u5230\u8fbe\u9884\u5b9a\u7684\u65f6\u957f\u7ed3\u675f\n    //2. \u6216\u8005\u624b\u52a8\u6309\u4e0b\u6309\u94ae\u5f55\u5236\u7ed3\u675f\n    override fun recordShouldEnd(time: Long) {\n        page.captureVideoBtn.visibility = View.VISIBLE\n        LogUtils.dTag(\"\u5f55\u5236activity\", \"\u505c\u6b62\")\n        cameraXF.stopRecord(time)\n        page.switchBtn.visibility=View.VISIBLE\n    }\n})\n</code></pre>"},{"location":"%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90/","title":"\u56fe\u50cf\u5206\u6790","text":""},{"location":"%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90/#_1","title":"\u524d\u8a00","text":""},{"location":"%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90/#imageanalyzer","title":"imageAnalyzer\u7528\u4f8b","text":""},{"location":"%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90/#mlkit","title":"mlkit","text":""},{"location":"%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90/#tensorflow","title":"tensorflow","text":""},{"location":"%E5%AD%98%E5%82%A8%E9%85%8D%E7%BD%AE/","title":"\u5b58\u50a8\u914d\u7f6e","text":"<p><code>CameraXStoreConfig</code> object\u7c7b\uff0c\u5b58\u50a8\u914d\u7f6e\u5168\u5c40\u751f\u6548\u3002</p> \u51fd\u6570 \u63cf\u8ff0 configPhoto \u914d\u7f6e\u62cd\u7167\u5b58\u50a8\u4f4d\u7f6e configVideo \u914d\u7f6e\u5f55\u5236\u5b58\u50a8\u4f4d\u7f6e <p>\u4e00\u5171\u6709\u4e09\u79cd\u5b58\u50a8\u65b9\u5f0f\uff1afile\uff0cMediaStore\uff0csaf\u8bbf\u95ee\u6846\u67b6\u3002 \u82e5\u4e0d\u8fdb\u884c\u914d\u7f6e\uff0c\u5219\u9ed8\u8ba4\u5b58\u50a8\u5230\u76f8\u518c\u7684<code>CameraX</code>\u6587\u4ef6\u5939\u4e0b</p> <ol> <li>\u8c03\u7528CameraXStoreConfig.configPhoto()\u914d\u7f6e\u56fe\u7247\u5b58\u50a8\u4f4d\u7f6e</li> <li>\u8c03\u7528CameraXStoreConfig.configVideo()\u914d\u7f6e\u5f55\u5236\u5b58\u50a8\u4f4d\u7f6e\uff0c\u4f7f\u7528\u65b9\u5f0f\u4e0e\u914d\u7f6e\u56fe\u7247\u6ca1\u6709\u533a\u522b\uff0c\u4ec5\u65b9\u6cd5\u540d\u79f0\u4e0d\u540c</li> </ol>"},{"location":"%E5%AD%98%E5%82%A8%E9%85%8D%E7%BD%AE/#_2","title":"\u63a8\u8350\u5b58\u50a8\u8bbe\u7f6e","text":"<ol> <li>\u5bf9\u4e8eandroid10\u4ee5\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528file\u65b9\u5f0f\u5b58\u50a8\u3002</li> <li>\u5bf9\u4e8eandroid10\u4ee5\u4e0a\uff0c\u7531\u4e8e\u5b58\u50a8\u6743\u9650\u6536\u7d27<ul> <li>\u5bf9\u4e8e\u5b58\u5165app\u81ea\u8eab\u76ee\u5f55\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528file</li> <li>\u5bf9\u4e8e\u5b58\u5165\u76f8\u518c\u3001\u89c6\u9891\u76ee\u5f55\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528MediaStore</li> <li>\u5bf9\u4e8e\u5176\u4ed6\u76ee\u5f55\u7684\uff0c\u53ef\u4ee5\u4f7f\u7528saf\u6846\u67b6</li> </ul> </li> </ol>"},{"location":"%E5%AD%98%E5%82%A8%E9%85%8D%E7%BD%AE/#_3","title":"\u4f7f\u7528\u793a\u4f8b","text":"<p>\u89c6\u9891\u7684\u5b58\u50a8\u914d\u7f6e\u540c\u62cd\u7167\u7684\u5b58\u50a8\u914d\u7f6e\u76f8\u540c\uff0c\u4e0d\u8fc7\u662f\u628a\u540d\u79f0\u4ece<code>configPhoto</code>\u6362\u6210<code>configVideo</code> .\u53ef\u4ee5\u53c2\u8003app\u793a\u4f8b\u4e2d\u7684MainActivity</p> <ul> <li>\u4f7f\u7528file\u7edd\u5bf9\u8def\u5f84\u5b58\u50a8</li> </ul> <pre><code>val targetDir = \"fff\" //\u76ee\u6807\u6587\u4ef6\u5939\nCameraXStoreConfig.configPhoto(\n    IStore.FileStoreConfig(\n        application.cacheDir.absolutePath,\n        targetDir\n    )\n)\n</code></pre> <ul> <li>\u4f7f\u7528MediaStore\u5b58\u50a8</li> </ul> <pre><code>CameraXStoreConfig.configPhoto(\n    IStore.MediaStoreConfig(\n        saveCollection = FileLocate.IMAGE.uri,\n        mediaFolder = Environment.DIRECTORY_DCIM,\n        targetFolder = relativePath\n    )\n)\n</code></pre> <ul> <li>\u4f7f\u7528SAF\u6846\u67b6\u5b58\u50a8\u5230\u4efb\u610f\u6587\u4ef6\u5939</li> </ul> <pre><code>StoreX.with(this).safHelper.requestOneFolder { it -&gt;\n    //\u4f7f\u7528SAF\u6846\u67b6\u83b7\u53d6\u67d0\u4e00\u4e2a\u6587\u4ef6\u5939\u7684\u6388\u6743\u548curi\uff0c\u7136\u540e\u914d\u7f6e\u5b58\u50a8\n    CameraXStoreConfig.configPhoto(\n        IStore.SAFStoreConfig(it)\n    )\n}\n</code></pre>"},{"location":"%E5%AD%98%E5%82%A8%E9%85%8D%E7%BD%AE/#_4","title":"\u62cd\u6444\u5b8c\u6210\uff0c\u5f55\u5236\u7ed3\u675f\uff0c\u83b7\u53d6\u6587\u4ef6\u5730\u5740","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u5728<code>CameraExampleActivity</code>\u6216<code>CameraExampleActivity2</code>\u4e2d \u90fd\u5b9e\u73b0\u4e86<code>CaptureResultListener</code>\u63a5\u53e3\u6765\u63a5\u6536\u62cd\u6444\u3001\u5f55\u5236\u5b8c\u6210\u7684\u4e8b\u4ef6\u3002</p> <p>\u56e0\u6b64\uff0c\u5728\u63a5\u53e3\u7684\u65b9\u6cd5\u53c2\u6570\u4e2d\uff0c\u53ef\u4ee5\u83b7\u53d6\u5230\u62cd\u6444\u3001\u5f55\u5236\u5b8c\u6210\u540e\u7684\u6587\u4ef6\u5730\u5740\u3002</p> <pre><code>/**\n * \u62cd\u5b8c\u7167\u7247\n */\noverride fun onPhotoTaken(saveFileData: SaveFileData?) {\n   super.onPhotoTaken(saveFileData)\n   Log.d(\"CameraXFragment\", \"onPhotoTaken\uff1a $saveFileData\")\n   cameraXF.indicateTakePhoto()//\u62cd\u7167\u95ea\u5149\n}\n\n/**\n * \u5f55\u5b8c\u89c6\u9891\n */\noverride fun onVideoRecorded(saveFileData: SaveFileData?) {\n   super.onVideoRecorded(saveFileData)\n   saveFileData?.let {\n      Log.d(TAG, \"onVideoRecorded: $it\")\n   }\n}\n</code></pre>"},{"location":"%E5%AD%98%E5%82%A8%E9%85%8D%E7%BD%AE/#savefiledata","title":"SaveFileData\u7c7b","text":"<ul> <li>\u63cf\u8ff0\u6587\u4ef6\u5b58\u50a8\u4f4d\u7f6e</li> <li>\u82e5\u4f7f\u7528\u4e86MediaStore\uff0cpath\u4e3a\u7a7a\uff0curi\u4e3acontent\u5f00\u5934</li> <li>\u82e5\u4f7f\u7528\u6587\u4ef6\uff0cpath\u4e0d\u4e3a\u7a7a\uff0curi\u4e3afile\u5f00\u5934</li> <li>\u82e5\u4f7f\u7528SAF\uff0cpath\u4e3a\u7a7a\uff0curi\u4e3acontent\u5f00\u5934</li> </ul>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/","title":"\u5b9e\u73b0\u81ea\u5b9a\u4e49\u76f8\u673a","text":""},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#_1","title":"\u81ea\u5b9a\u4e49\u754c\u9762","text":"<p>\u9996\u5148\u8981\u77e5\u9053\u7684\u662f\uff0c<code>CameraHolder</code>\u7c7b\u5b9e\u73b0\u4e86\u76f8\u673a\u7684\u6240\u6709\u529f\u80fd\uff0c\u4f8b\u5982\u7528\u4f8b\u5207\u6362\uff0c\u62cd\u7167\uff0c\u5f55\u50cf\uff0c\u56fe\u50cf\u5206\u6790\u7b49\u529f\u80fd\u3002</p> <p>\u800c<code>CameraXFragment</code>\u5219\u662f\u6700\u57fa\u672c\u7684\u76f8\u673a\u754c\u9762\u5b9e\u73b0\u7c7b\uff0c\u5b83\u5728\u5e03\u5c40\u4e2d\u4ec5\u9700\u8981\u4e00\u4e2a<code>PreviewView</code>\u5b9e\u73b0\u9884\u89c8\uff0c\u4ee5\u53ca\u901a\u8fc7\u6301\u6709<code>CameraHolder</code>\u6765\u63a7\u5236\u548c\u63d0\u4f9b\u76f8\u673a\u5404\u9879\u529f\u80fd\u3002</p> <p>\u800c\u5728app module\u4e2d\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86<code>CameraExampleActivity</code>\u548c<code>CameraExampleActivity2</code>\u4e24\u4e2a\u76f8\u673a\u5b9e\u73b0\u7684\u4f8b\u5b50\u3002 \u524d\u8005\u7ee7\u627f\u81ea<code>BaseCameraXActivity</code>\u3002\u540e\u8005\u5c06<code>BaseCameraXFragment</code>\u653e\u5165\u5e03\u5c40\u7684<code>FragmentContainerView</code>\u4e2d\u3002</p> <ul> <li><code>BaseCameraXActivity</code>\u7c7b\u5219\u662f\u5c06<code>CameraXFragment</code>\u653e\u5165\u5e03\u5c40\u7684<code>FragmentContainerView</code>\u4e2d\u3002\u5e76\u63d0\u4f9b\u4e86\u62cd\u7167\u6309\u94ae\uff0c\u95ea\u5149\u706f\u6309\u94ae\uff0c\u70b9\u51fb\u5bf9\u7126\u6309\u94ae\u7b49\u754c\u9762\u5143\u7d20\u3002</li> <li><code>BaseCameraXFragment</code>\u7c7b\u7ee7\u627f\u81ea<code>CameraXFragment</code>\uff0c\u4fee\u6539\u4e86\u5e03\u5c40\u6587\u4ef6\uff0c\u5e76\u63d0\u4f9b\u4e86\u62cd\u7167\u6309\u94ae\uff0c\u95ea\u5149\u706f\u6309\u94ae\uff0c\u70b9\u51fb\u5bf9\u7126\u6309\u94ae\u7b49\u754c\u9762\u5143\u7d20\u3002</li> </ul>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#basecameraxfragmentbasecameraxactivity","title":"\u4eceBaseCameraXFragment\u6216BaseCameraXActivity\u81ea\u5b9a\u4e49\u754c\u9762","text":"<p>Note</p> <p><code>BaseCameraXFragment</code>\u6216<code>BaseCameraXActivity</code>\u662f\u529f\u80fd\u754c\u9762\u7684\u7b80\u5355\u5b9e\u73b0\uff0c\u63d0\u4f9b\u7684\u81ea\u5b9a\u4e49\u529f\u80fd\u975e\u5e38\u7684\u6709\u9650\uff0c\u66f4\u591a\u7684\u662f\u544a\u8bc9\u4f60\u600e\u4e48\u5b9e\u73b0\u4e00\u4e2a\u529f\u80fd\u754c\u9762\u3002 \u5982\u679c\u4f60\u9700\u8981\u5b8c\u5168\u81ea\u5b9a\u4e49\u7684\u529f\u80fd\u754c\u9762\uff0c\u53ef\u4ee5\u53c2\u7167\u8fd9\u4e24\u4e2a\u7c7b\uff0c\u5e76\u4f7f\u7528<code>CameraXFragment</code>\u5b9e\u73b0\u5b8c\u5168\u81ea\u5b9a\u4e49\u7684\u529f\u80fd\u754c\u9762</p> <p><code>BaseCameraXFragment</code>\u6216<code>BaseCameraXActivity</code>\u4e00\u4e2a\u662ffragment\uff0c\u4e00\u4e2a\u662factivity\uff0c</p> <p>\u4f46\u4ed6\u4eec\u7684\u81ea\u5b9a\u4e49\u8fc7\u7a0b\u90fd\u662f\u76f8\u4f3c\u7684\uff0c\u4ed6\u4eec\u90fd\u5728\u5185\u90e8\u901a\u8fc7provideView\u65b9\u6cd5\u63d0\u4f9b\u754c\u9762\u5143\u7d20\u3002 \u4e14\u4f7f\u7528IControllerPanel\u63a5\u53e3\u6765\u5b9e\u73b0\u90e8\u5206\u901a\u7528\u754c\u9762\u5143\u7d20\u7684\u63a7\u5236\uff0c \u4f8b\u5982\u5e95\u90e8\u7684\u62cd\u7167\u6309\u94ae\uff0c\u62cd\u7167\u548c\u5f55\u50cf\u6309\u94ae\u5207\u6362\uff0c\u663e\u793a\u548c\u9690\u85cf\u5e95\u90e8\u754c\u9762\u7b49\u3002</p> <p>\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u9700\u8981\u81ea\u5b9a\u4e49\u754c\u9762\uff0c\u9700\u8981\u901a\u8fc7provideView\u65b9\u6cd5\u6765\u63d0\u4f9b\u754c\u9762\u5143\u7d20\uff0c\u5e76\u5b9e\u73b0\u4e00\u4e9b\u65b9\u6cd5\u63d0\u4f9b\u4ea4\u4e92\uff0c\u4f8b\u5982\u5b9e\u73b0IControllerPanel\u63a5\u53e3\u6765\u63a7\u5236\u754c\u9762\u5143\u7d20\u7684\u4ea4\u4e92\u529f\u80fd\u3002</p>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#basecameraxfragment-provideview","title":"BaseCameraXFragment provideView\u65b9\u6cd5","text":"<pre><code> override fun provideView(\n        inflater: LayoutInflater,\n        container: ViewGroup?,\n        savedInstanceState: Bundle?\n    ): View {\n\n        //\u81ea\u5b9a\u4e49\u7684\u5e03\u5c40\u6587\u4ef6\n        val viewRoot = FragmentCameraxExampleBinding.inflate(inflater, container, false)\n        //\u5904\u7406merge\u6807\u7b7e\n        val controllerPanelBinding = BottomControllerPanelBinding.bind(viewRoot.root)\n        //\u5e95\u90e8\u63a7\u5236\u9762\u677f\u4ea4\u4e92\u529f\u80fd\n        controllerPanel = ControllerPanel(requireActivity(), controllerPanelBinding)\n        //\u521d\u59cb\u5316\n        controllerPanel.initAll()\n        //\u4e8b\u4ef6\u76d1\u542c\n        controllerPanel.eventListener = object : IControllerPanelEventListener {\n            override fun switchCamera() {\n                //\u8981\u4fdd\u6301\u95ea\u5149\u706f\u4e0a\u4e00\u6b21\u7684\u6a21\u5f0f\n                if (canSwitchCamera()) {\n                    this@BaseCameraXFragment.switchCamera()\n                }\n            }\n\n            override fun switchCaptureBtnType(type: Int) {\n                //\u8fd9\u91cc\u53ef\u4ee5\u76d1\u542c\u5230\u5207\u6362\u6309\u94ae\u7684\u6a21\u5f0f\n            }\n        }\n        //\u62cd\u7167\uff0c\u62cd\u89c6\u9891\u7684UI \u64cd\u4f5c\u7684\u5404\u79cd\u72b6\u6001\u5904\u7406\n        (controllerPanel as ControllerPanel).setCaptureListener(object : DefaultCaptureListener() {\n            override fun takePictures() {\n                takePhoto()\n            }\n\n            //\u5f00\u59cb\u5f55\u5236\u89c6\u9891\n            override fun recordStart() {\n                LogUtils.dTag(\"\u5f55\u5236activity\", \"\u5f00\u59cb\")\n                startRecord()\n                controllerPanel.showHideCameraSwitch(true)\n                //\u5f55\u5236\u89c6\u9891\u65f6\u9690\u85cf\u6444\u50cf\u5934\u5207\u6362\n                if (!cameraConfig.recordConfig.asPersistentRecording) {\n                    controllerPanel.showHideUseCaseSwitch(true)\n                }\n            }\n\n            //1. \u5f55\u5236\u89c6\u9891\u5230\u8fbe\u9884\u5b9a\u7684\u65f6\u957f\u7ed3\u675f\n            //2. \u6216\u8005\u624b\u52a8\u6309\u4e0b\u6309\u94ae\u5f55\u5236\u7ed3\u675f\n            override fun recordShouldEnd(time: Long) {\n                LogUtils.dTag(\"\u5f55\u5236activity\", \"\u505c\u6b62\")\n                stopRecord(time)\n                controllerPanel.showHideCameraSwitch(false)\n                controllerPanel.showHideUseCaseSwitch(false)\n            }\n        })\n\n        super.onCreate(savedInstanceState)\n        return viewRoot.root\n    }\n</code></pre>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#basecameraxactivity-provideview","title":"BaseCameraXActivity provideView\u65b9\u6cd5","text":"<pre><code> open fun provideView(\n        savedInstanceState: Bundle?\n    ): View {\n        val page = ActivityCameraExampleBinding.inflate(layoutInflater)\n        val controllerPanelBinding = BottomControllerPanelBinding.bind(page.root)//\u5904\u7406merge\u6807\u7b7e\n        //\u5e95\u90e8\u63a7\u5236\u9762\u677f\u4ea4\u4e92\u529f\u80fd\n        controllerPanel = ControllerPanel(this, controllerPanelBinding)\n        controllerPanel.initAll()\n        controllerPanel.eventListener = object : IControllerPanelEventListener {\n            override fun switchCamera() {\n                //\u8981\u4fdd\u6301\u95ea\u5149\u706f\u4e0a\u4e00\u6b21\u7684\u6a21\u5f0f\n                if (cameraXFragment.canSwitchCamera()) {\n                    cameraXFragment.switchCamera()\n                }\n            }\n\n            override fun switchCaptureBtnType(type: Int) {\n                //\u8fd9\u91cc\u53ef\u4ee5\u76d1\u542c\u5230\u5207\u6362\u6309\u94ae\u7684\u6a21\u5f0f\n            }\n        }\n        //\u62cd\u7167\uff0c\u62cd\u89c6\u9891\u7684UI \u64cd\u4f5c\u7684\u5404\u79cd\u72b6\u6001\u5904\u7406\n        (controllerPanel as ControllerPanel).setCaptureListener(\n            object : DefaultCaptureListener() {\n                override fun takePictures() {\n                    cameraXFragment.takePhoto()\n                }\n\n                //\u5f00\u59cb\u5f55\u5236\u89c6\u9891\n                override fun recordStart() {\n                    LogUtils.dTag(\"\u5f55\u5236activity\", \"\u5f00\u59cb\")\n                    cameraXFragment.startRecord()\n                    controllerPanel.showHideCameraSwitch(true)\n                    //\u5f55\u5236\u89c6\u9891\u65f6\u9690\u85cf\u6444\u50cf\u5934\u5207\u6362\n                    if (!cameraConfig.recordConfig.asPersistentRecording) {\n                        controllerPanel.showHideUseCaseSwitch(true)\n                    }\n                }\n\n                //1. \u5f55\u5236\u89c6\u9891\u5230\u8fbe\u9884\u5b9a\u7684\u65f6\u957f\u7ed3\u675f\n                //2. \u6216\u8005\u624b\u52a8\u6309\u4e0b\u6309\u94ae\u5f55\u5236\u7ed3\u675f\n                override fun recordShouldEnd(time: Long) {\n                    LogUtils.dTag(\"\u5f55\u5236activity\", \"\u505c\u6b62\")\n                    cameraXFragment.stopRecord(time)\n                    controllerPanel.showHideCameraSwitch(false)\n                    controllerPanel.showHideUseCaseSwitch(false)\n\n                }\n            })\n        return page.root\n    }\n</code></pre>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#icontrollerpanel","title":"IControllerPanel\u63a5\u53e3","text":"<p>IControllerPanel\u63a5\u53e3\u662f\u4e3a\u4e86\u7edf\u4e00\u5904\u7406\u5e95\u90e8\u63a7\u5236\u9762\u677f\u7684UI\u64cd\u4f5c\uff0c\u6bd4\u5982\u70b9\u51fb\u5f55\u50cf\u65f6\uff0c\u9690\u85cf\u6444\u50cf\u5934\u5207\u6362\uff0c\u7528\u4f8b\u5207\u6362\u7b49ui\u3002</p> <pre><code>interface IControllerPanel {\n    //\u8fd9\u4e2a\u662f\u76d1\u542c\u9762\u677f\u4e8b\u4ef6\uff0c\u62cd\u7167\u6309\u94ae\u70b9\u51fb\uff0c\u5f55\u50cf\u6309\u94ae\u70b9\u51fb\uff0c\u5207\u6362\u76f8\u673a\u6309\u94ae\u70b9\u51fb\u7b49\n    var eventListener: IControllerPanelEventListener?\n    //\u8bbe\u7f6e\u5207\u6362\u62cd\u7167\u6216\u5f55\u5236\u6309\u94ae\u6587\u5b57\u989c\u8272\n    fun setBottomButtonTextColor(id: Int)\n    //\u663e\u793a\u6216\u9690\u85cf\u524d\u540e\u955c\u5934\u5207\u6362\n    fun showHideCameraSwitch(hide: Boolean = true)\n    //\u663e\u793a\u6216\u9690\u85cf\u5207\u6362\u7528\u4f8b\u6309\u94ae\n    fun showHideUseCaseSwitch(hide: Boolean = true)\n    //\u663e\u793a\u9690\u85cf\u62cd\u7167\u6309\u94ae\uff0c\u76f8\u518c\u7b49\n    fun showHideControllerButton(hide: Boolean = true)\n    //\u521d\u59cb\u5316\u6240\u6709ui\n    fun initAll()\n    //\u663e\u793a\u6216\u9690\u85cf\u6240\u6709ui\n    fun showHideAll(hide: Boolean)\n}\n\ninterface IControllerPanelEventListener {\n    //\u901a\u77e5\u524d\u540e\u955c\u5934\u5207\u6362\n    fun switchCamera()\n    //\u901a\u77e5\u5207\u6362\u62cd\u7167\u6216\u5f55\u50cf\u6309\u94ae\n    fun switchCaptureBtnType(type: Int)\n}\n</code></pre>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#cameraxfragment","title":"\u4ece\u6700\u57fa\u7840\u7684CameraXFragment\u81ea\u5b9a\u4e49\u754c\u9762","text":"<p>\u8fd9\u4e00\u90e8\u5206\u975e\u5e38\u7684\u7b80\u5355\u3002</p> <ul> <li>\u5982\u679c\u7528fragment\u5b9e\u73b0\uff0c\u5219\u7ee7\u627f<code>CameraXFragment</code>\u5373\u53ef\u3002</li> <li>\u5982\u679c\u7528activity\u5b9e\u73b0\uff0c\u5219\u5c06<code>CameraXFragment</code>\u653e\u5165\u5408\u9002\u7684\u5bb9\u5668\u4e2d\u5373\u53ef\u3002</li> </ul> <p>\u5177\u4f53\u7684\u5b9e\u73b0\u53ef\u4ee5\u53c2\u7167<code>BaseCameraXFragment</code>\u548c<code>BaseCameraXActivity</code></p>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#_2","title":"\u81ea\u5b9a\u4e49\u7528\u4f8b","text":"<ul> <li><code>UseCaseHolder</code> \u7c7b\u521d\u59cb\u5316\u9884\u89c8\uff0c\u62cd\u7167\u7528\u4f8b\uff0c\u5f55\u50cf\u7528\u4f8b\uff0c\u56fe\u50cf\u5206\u6790\u7528\u4f8b</li> <li>\u63d0\u4f9b\u8bbe\u7f6e\u521d\u59cb\u5316\u7528\u4f8b\u65b9\u6cd5</li> <li>\u63d0\u4f9b\u5206\u8fa8\u7387\u548c\u7eb5\u6a2a\u6bd4\u7b5b\u9009\u65b9\u5f0f</li> </ul>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#_3","title":"\u6307\u5b9a\u9884\u89c8\u4e0e\u62cd\u7167\u6240\u9700\u8981\u7684\u5206\u8fa8\u7387\u4e0e\u7eb5\u6a2a\u6bd4\u7b5b\u9009","text":"<p>\u4fee\u6539UseCaseHolder.resolutionSelector\u53d8\u91cf\uff0c\u63d0\u4f9b\u9884\u89c8\u4e0e\u62cd\u7167\u6240\u9700\u8981\u7684\u5206\u8fa8\u7387\u4e0e\u7eb5\u6a2a\u6bd4\u7b5b\u9009</p> <pre><code>    //\u6307\u5b9a\u7b5b\u9009\u6761\u4ef6\u7528\u4e8e\u9884\u89c8\u548c\u62cd\u7167\n    UseCaseHolder.resolutionSelector = ResolutionSelector.Builder()\n        //\u5206\u8fa8\u7387\u7b5b\u9009\n        .setResolutionFilter { supportedSizes, rotationDegrees -&gt;\n            supportedSizes\n        }\n        //\u7eb5\u6a2a\u6bd4\u9009\u62e9\u7b56\u7565 16:9 \u6bd4\u4f8b\n        .setAspectRatioStrategy(AspectRatioStrategy.RATIO_16_9_FALLBACK_AUTO_STRATEGY)\n        //\u5206\u8fa8\u7387\u7b56\u7565\u9009\u62e9\u6700\u9ad8\u53ef\u7528\u5206\u8fa8\u7387\n        .setResolutionStrategy(ResolutionStrategy.HIGHEST_AVAILABLE_STRATEGY)\n        //\u8bbe\u7f6e\u5141\u8bb8\u7684\u5206\u8fa8\u7387\u6a21\u5f0f\u3002\n        .setAllowedResolutionMode(ResolutionSelector.PREFER_CAPTURE_RATE_OVER_HIGHER_RESOLUTION)\n        .build()\n</code></pre>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#_4","title":"\u4fee\u6539\u9ed8\u8ba4\u7684\u7528\u4f8b\u521d\u59cb\u5316","text":"<p>\u5982\u9ed8\u8ba4\u7684\u521d\u59cb\u5316\u4e0d\u6ee1\u8db3\u9700\u8981\uff0c\u53ef\u4ee5\u8c03\u7528[setInitImpl]\u65b9\u6cd5\uff0c\u63d0\u4f9b\u81ea\u5df1\u6240\u9700\u8981\u7684\u521d\u59cb\u5316 \u793a\u4f8b\uff1a\u4f7f\u67d0\u4e2a\u7c7b\u7ee7\u627f\u81eaIUseCaseHelper\uff0c\u5e76\u5b9e\u73b0\u521d\u59cb\u5316\u9884\u89c8\uff0c\u62cd\u7167\u7528\u4f8b\uff0c\u5f55\u50cf\u7528\u4f8b\uff0c\u56fe\u50cf\u5206\u6790\u7528\u4f8b\u7684\u65b9\u6cd5   <pre><code>class IMPL:IUseCaseHelper{\n  ........\u7701\u7565\n override fun initVideoCapture(\n      cameraExecutor: ExecutorService,\n      screenAspectRatio: Int,\n      rotation: Int,\n      size: Size,\n      cameraConfig: ManagerConfig\n  ): androidx.camera.video.VideoCapture&lt;Recorder&gt; {\n      val videoCapture =\n          OnceRecorderHelper.getVideoCapture(cameraExecutor, rotation, cameraConfig.recordConfig)\n      return videoCapture\n  }\n  ........\u7701\u7565\n\n}\nval impl =IMPL()\n//\u5728\u76f8\u673a\u521d\u59cb\u5316\u4e4b\u524d\u8c03\u7528\uff0c\u63d0\u4f9b\u81ea\u5df1\u7684\u5b9e\u73b0\nUseCaseHolder.setInitImpl(impl)\n</code></pre></p>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#_5","title":"\u81ea\u5b9a\u4e49\u7528\u4f8b\u7ec4\u5408","text":"<p>\u5728\u4e0a\u4e00\u6b65\u4e2d\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86\u81ea\u5b9a\u4e49\u7684\u521d\u59cb\u5316\u7528\u4f8b\u7684\u5b9e\u73b0\u3002  </p> <p>\u5728\u76f8\u673a\u914d\u7f6e\u7684\u7528\u4f8b\u6a21\u5f0f\u90e8\u5206\uff0c\u6211\u4eec\u8bb2\u914d\u7f6e\u76f8\u673a\u542f\u52a8\u65f6\u7684\u6a21\u5f0f\u5c31\u662f\u5728\u6307\u5b9a\u7528\u4f8b\u7ec4\u5408\u3002  </p> <p>\u5176\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528<code>UseCaseMode.customGroup</code>\u65b9\u6cd5\u81ea\u5b9a\u4e49\u7528\u4f8b\u7ec4\u5408\u3002 \u5982\u679c\u662f\u4e0d\u652f\u6301\u7684\u7528\u4f8b\u7ec4\u5408\uff0c\u4f1a\u629b\u51fa\u5f02\u5e38\u3002 </p> <pre><code>return ManagerConfig().apply {\n            this.recordConfig = videoRecordConfig\n            this.useCaseMode =  //\u901a\u8fc7\u8c03\u7528UseCaseMode.customGroup\u65b9\u6cd5\u81ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53ef\u4ee5\u9884\u89c8\uff0c\u5f55\u50cf\uff0c\u56fe\u50cf\u5206\u6790\u7684\u7528\u4f8b\u7ec4\u5408\n                UseCaseMode.customGroup(\n                    UseCaseHexStatus.USE_CASE_PREVIEW,\n                    UseCaseHexStatus.USE_CASE_IMAGE_ANALYZE,\n                    UseCaseHexStatus.USE_CASE_VIDEO_CAPTURE\n                )\n            this.flashMode = FlashModel.CAMERA_FLASH_AUTO\n            //android R\u4ee5\u4e0b\u65f6\uff0c\u5728\u5c11\u6570display\u4e3anull\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbe\u7f6e\u9884\u89c8\uff0c\u62cd\u7167\u7684\u9ed8\u8ba4\u5206\u8fa8\u7387\n            this.size = Size(1920, 1080)\n        }\n</code></pre>"},{"location":"%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%B8%E6%9C%BA/#_6","title":"\u65b9\u6cd5\u8c03\u7528\u65f6\u5e8f","text":"<p>[new Fragment()]-&gt; [Fragment.onViewCreated]-&gt; [initCameraHolder(\u751f\u6210\u5e76\u521d\u59cb\u5316CameraHolder)] -&gt;[CameraXFragmentEventListener.cameraHolderInitStart] -&gt; [CameraXManager.bindLifecycle] -&gt;[CameraXManager.initManager]-&gt;[CameraManagerEventListener.initCameraStart]-&gt;initCamera\u3001initUseCase -&gt;\u7ed1\u5b9aUseCase -&gt;[CameraManagerEventListener.initCameraFinished]-&gt;[CameraXFragmentEventListener.cameraHolderInitFinish]  </p>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/","title":"\u76f8\u673a\u914d\u7f6e","text":""},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#_1","title":"\u521d\u59cb\u5316\u914d\u7f6e\uff1a","text":"<p>\u5185\u90e8\u539f\u7406\uff1a <code>ManagerConfig</code>\u7c7b\u6301\u6709\u4e86\u76f8\u673a\u7684\u5404\u7c7b\u529f\u80fd\u53c2\u6570\uff0c \u5728\u6784\u9020CameraXFragment\u65f6\u7531\u6784\u9020\u51fd\u6570\u5c06\u914d\u7f6e\u7c7b(<code>ManagerConfig</code>)\u4f20\u5165\u3002</p> <pre><code> cameraXFragment = CameraXFragment.newInstance(\n            //\u76f8\u673a\u7684\u521d\u59cb\u5316\u914d\u7f6e\n            cameraConfig,\n            //\u8bbe\u7f6e\u521d\u59cb\u5316\u4e8b\u4ef6\u76d1\u542c\n            eventListener = this,\n            //\u62cd\u7167\u5f55\u89c6\u9891\u64cd\u4f5c\u7ed3\u679c\u901a\u77e5\u56de\u8c03\n            captureResultListener = this\n        )\n</code></pre> <p>Note</p> <p>\u5728\u901a\u8fc7<code>BaseCameraXActivity</code>\u5b9e\u73b0\u81ea\u5b9a\u4e49\u76f8\u673a\u65f6\uff0c\u53ef\u4ee5\u91cd\u5199configAll\u65b9\u6cd5\uff0c\u81ea\u5b9a\u4e49\u76f8\u673a\u914d\u7f6e \u5728\u901a\u8fc7<code>BaseCameraXFragment</code>\u5b9e\u73b0\u81ea\u5b9a\u4e49\u76f8\u673a\u65f6\uff0c\u76f4\u63a5\u7531\u6784\u9020\u51fd\u6570\u4f20\u5165\u5373\u53ef\u3002</p>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#cameraexampleactivity","title":"\u793a\u4f8bCameraExampleActivity \u4e2d\u7684\u914d\u7f6e\u65b9\u5f0f","text":"<p><code>BaseCameraXActivity</code>\u7c7b\u5b9a\u4e49\u4e86\u4e00\u4e2a<code>configAll</code>\u65b9\u6cd5\uff0c\u5b83\u63a5\u6536\u4f20\u5165\u7684intent\uff0c\u5e76\u8fd4\u56de\u76f8\u673a\u914d\u7f6e(ManagerConfig)</p> <pre><code>    abstract fun configAll(intent: Intent): ManagerConfig\n</code></pre> <p>\u901a\u8fc7\u7ee7\u627f<code>BaseCameraXActivity</code>\u5b9e\u73b0\u81ea\u5b9a\u4e49\u76f8\u673a\u65f6\uff0c\u9700\u8981\u91cd\u5199configAll\u65b9\u6cd5\uff0c\u751f\u6210\u76f8\u673a\u914d\u7f6e(ManagerConfig)\u3002 intent\u53c2\u6570\u6765\u81ea\u4e8e\u4f60\u8c03\u7528startActivity\u65f6\u7684\u4f20\u5165\uff0c\u4e0e\u672c\u5e93\u65e0\u5173\uff0c\u4f60\u4e0d\u7528intent\u4f20\u53c2\u53ef\u4ee5\u5ffd\u7565\u8fd9\u4e2a\u53c2\u6570\u3002</p> <pre><code>class CameraExampleActivity : BaseCameraXActivity() {\n    // CameraExampleActivity\u4e2d\u901a\u8fc7\u91cd\u5199configAll \u53ef\u914d\u7f6e\u76f8\u673a\u4e00\u4e9b\u5185\u5bb9\n    // \u63a5\u6536\u5230intent\uff0c\u5bf9\u76f8\u673a\u8fdb\u884c\u914d\u7f6e\n  override fun configAll(intent: Intent): ManagerConfig {\n    //\u89c6\u9891\u5f55\u5236\u914d\u7f6e(\u53ef\u9009)\n    val videoRecordConfig = VideoRecordConfig(\n      quality = CameraRecordQuality.HD,//\u8bbe\u7f6e\u89c6\u9891\u62cd\u6444\u8d28\u91cf\n//            fileSizeLimit=100.mb, //\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u3002\n//            durationLimitMillis =1000*15, //\u5f55\u5236\u65f6\u957f\u9650\u5236\uff0c\u5355\u4f4d\u6beb\u79d2\n      //...\u7701\u7565\n    )\n    //\u62cd\u7167\u914d\u7f6e(\u53ef\u9009)\n    val imageCaptureConfig =ImageCaptureConfig(\n      horizontalMirrorMode= MirrorMode.MIRROR_MODE_ON_FRONT_ONLY, //\u6c34\u5e73\u7ffb\u8f6c\n      verticalMirrorMode = MirrorMode.MIRROR_MODE_ON_FRONT_ONLY, //\u5782\u76f4\u7ffb\u8f6c\n      //...\u7701\u7565\n    )\n    val useImageDetection = intent.getBooleanExtra(ImageDetection, false)    //\u662f\u5426\u4f7f\u7528\u56fe\u50cf\u5206\u6790\n\n    //\u6784\u5efa\u76f8\u673a\u914d\u7f6e\u5e76\u8fd4\u56de\n    return ManagerConfig().apply { //return \u76f8\u673a\u914d\u7f6e\u5b9e\u4f8b\n      this.recordConfig = videoRecordConfig \n        //\u8fd9\u91cc\u6307\u5b9a\u4e86\u6253\u5f00\u76f8\u673a\u65f6\u7684\u9ed8\u8ba4\u7528\u4f8b\u6a21\u5f0f\uff0c\u56fe\u50cf\u5206\u6790\u3001\u62cd\u7167\u3001\u5f55\u50cf\u7b49\u3002\u5176\u5b9e\u5c31\u662f\u6307\u5b9a\u76f8\u673a\u7684\u7528\u4f8b\u7ec4\u5408\n      this.useCaseMode =\n        if (useImageDetection) UseCaseMode.imageAnalysis else UseCaseMode.takePhoto\n        //\u95ea\u5149\u706f\u914d\u7f6e\n      this.flashMode = FlashModel.CAMERA_FLASH_AUTO\n      //android R\u4ee5\u4e0b\u65f6\uff0c\u5728\u5c11\u6570display\u4e3anull\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbe\u7f6e\u9884\u89c8\uff0c\u62cd\u7167\u7684\u9ed8\u8ba4\u5206\u8fa8\u7387\n      this.size = Size(1920, 1080)\n    }\n  }\n}\n</code></pre>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#cameraexampleactivity2","title":"\u793a\u4f8bCameraExampleActivity2 \u4e2d\u7684\u914d\u7f6e\u65b9\u5f0f","text":"<p>\u901a\u8fc7<code>BaseCameraXFragment</code>\u5b9e\u73b0\u81ea\u5b9a\u4e49\u76f8\u673a\uff0c\u6ca1\u6709\u4e0a\u9762\u90a3\u6837\u7684configAll\u65b9\u6cd5\uff0c\u6bd5\u7adf\u4f60\u9700\u8981\u624b\u52a8\u751f\u6210\u627f\u8f7d\u76f8\u673a\u7684fragment\uff0c\u4ee5\u53ca\u5c06\u5b83\u653e\u5165\u5408\u9002\u7684\u5e03\u5c40\u4e2d\u3002</p> <p>\u4f60\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6cd5\u7528\u4e8e\u751f\u6210\u914d\u7f6e\u5185\u5bb9\uff0c\u4ee5\u53ca\u63a5\u6536intent\u4f20\u5165\uff0c\u751f\u6210\u76f8\u673a\u914d\u7f6e(ManagerConfig)\u3002</p> <p>\u6700\u7ec8\uff0c\u5728\u627f\u8f7d\u76f8\u673a\u529f\u80fd\u7684<code>BaseCameraXFragment</code>\u7684<code>newInstance</code>\u65b9\u6cd5\u4e2d\u4f20\u5165\u914d\u7f6e\u5373\u53ef\u3002</p> <pre><code>class CameraExampleActivity2 : AppCompatActivity(), CameraXFragmentEventListener,\n    CaptureResultListener {\n    lateinit var cameraConfig: ManagerConfig\n    var cameraXFragment: BaseCameraXFragment? = null\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_fragment_container)\n\n        cameraConfig = parse(intent)//\u4f8b\u5982\u4eceintent\u4e2d\u63a5\u53d7\u914d\u7f6e\uff0c\u6784\u9020\u51faManagerConfig\n        //\u8fd9\u91cc\uff0c\u751f\u6210\u4e86\u627f\u8f7d\u76f8\u673a\u7684fragment\uff0c\u5e76\u5c06\u5176\u653e\u5165\u5408\u9002\u7684\u5e03\u5c40\u4e2d\n        cameraXFragment = BaseCameraXFragment.newInstance(\n            cameraConfig, //\u5c06\u914d\u7f6e\u4f20\u5165\n            //\u8bbe\u7f6e\u521d\u59cb\u5316\u4e8b\u4ef6\u76d1\u542c\n            eventListener = this,\n            //\u62cd\u7167\u5f55\u89c6\u9891\u64cd\u4f5c\u7ed3\u679c\u901a\u77e5\u56de\u8c03\n            captureResultListener = this\n        )\n        supportFragmentManager.beginTransaction()\n            .replace(com.kiylx.camerax_lib.R.id.fragment_container, cameraXFragment!!).commit()\n    } \n\n    //\u89e3\u6790intent\uff0c\u6216\u5176\u4ed6\u4ec0\u4e48\uff0c\u751f\u6210\u76f8\u673a\u914d\u7f6e(ManagerConfig)\u5e76\u8fd4\u56de\n    fun parse(intent:Intent):ManagerConfig{\n        return ManagerConfig().apply { //return \u76f8\u673a\u914d\u7f6e\u5b9e\u4f8b\n            //\u8fd9\u91cc\u6307\u5b9a\u4e86\u6253\u5f00\u76f8\u673a\u65f6\u7684\u9ed8\u8ba4\u7528\u4f8b\u6a21\u5f0f\uff0c\u56fe\u50cf\u5206\u6790\u3001\u62cd\u7167\u3001\u5f55\u50cf\u7b49\u3002\u5176\u5b9e\u5c31\u662f\u6307\u5b9a\u76f8\u673a\u7684\u7528\u4f8b\u7ec4\u5408\n            this.useCaseMode = UseCaseMode.takePhoto\n            //\u95ea\u5149\u706f\u914d\u7f6e\n            this.flashMode = FlashModel.CAMERA_FLASH_AUTO\n            //android R\u4ee5\u4e0b\u65f6\uff0c\u5728\u5c11\u6570display\u4e3anull\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbe\u7f6e\u9884\u89c8\uff0c\u62cd\u7167\u7684\u9ed8\u8ba4\u5206\u8fa8\u7387\n            this.size = Size(1920, 1080)\n        }\n    }\n}\n</code></pre>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#_2","title":"\u7528\u4f8b\u6a21\u5f0f","text":"<p>\u6211\u4eec\u5728\u4e0a\u9762\u914d\u7f6e\u76f8\u673a\u65f6\uff0c\u793a\u4f8b\u4ee3\u7801\u4e2d\u53ef\u4ee5\u914d\u7f6e\u76f8\u673a\u542f\u52a8\u65f6\u7684\u7528\u4f8b\u6a21\u5f0f\uff0c\u6bd4\u5982\u4ee5\u62cd\u7167\u6a21\u5f0f\u542f\u52a8\uff0c\u4ee5\u56fe\u50cf\u5206\u6790\u6a21\u5f0f\u542f\u52a8\u3002\u5176\u5b9e\u5c31\u662f\u5728\u6307\u5b9a\u7528\u4f8b\u7ec4\u5408</p> <ul> <li>\u914d\u7f6e\u76f8\u673a\u542f\u52a8\u65f6\u7684\u7528\u4f8b\u6a21\u5f0f <pre><code>return ManagerConfig().apply { //return \u76f8\u673a\u914d\u7f6e\u5b9e\u4f8b\n//    \u8fd9\u91cc\u6307\u5b9a\u4e86\u6253\u5f00\u76f8\u673a\u65f6\u7684\u9ed8\u8ba4\u6a21\u5f0f\uff0c\u56fe\u50cf\u5206\u6790\u3001\u62cd\u7167\u3001\u5f55\u50cf\u7b49\u3002\n      this.useCaseMode = UseCaseMode.imageAnalysis\n}\n</code></pre></li> </ul> <p>\u6211\u4eec\u6709\u5982\u4e0b\u51e0\u79cd\u7528\u4f8b\u7ec4\u5408\u65b9\u5f0f\uff0c\u53ef\u76f4\u63a5\u7528\u4e8e\u914d\u7f6eManagerConfig\u4e2d\u7684useCaseBundle\u5b57\u6bb5\uff0c\u8fd8\u53ef\u4ee5\u8c03\u7528<code>UseCaseMode.customGroup</code>\u65b9\u6cd5\u81ea\u5b9a\u4e49\u7528\u4f8b\u7ec4\u5408\uff0c</p> <p>\u81ea\u5b9a\u4e49\u7528\u4f8b\u7ec4\u5408\uff0c\u4f8b\u5982\uff1a <pre><code>return ManagerConfig().apply {\n            this.recordConfig = videoRecordConfig\n            this.useCaseMode =  //\u901a\u8fc7\u8c03\u7528UseCaseMode.customGroup\u65b9\u6cd5\u81ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53ef\u4ee5\u9884\u89c8\uff0c\u5f55\u50cf\uff0c\u56fe\u50cf\u5206\u6790\u7684\u7528\u4f8b\u7ec4\u5408\n                UseCaseMode.customGroup(\n                    UseCaseHexStatus.USE_CASE_PREVIEW,\n                    UseCaseHexStatus.USE_CASE_IMAGE_ANALYZE,\n                    UseCaseHexStatus.USE_CASE_VIDEO_CAPTURE\n                )\n            this.flashMode = FlashModel.CAMERA_FLASH_AUTO\n            //android R\u4ee5\u4e0b\u65f6\uff0c\u5728\u5c11\u6570display\u4e3anull\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbe\u7f6e\u9884\u89c8\uff0c\u62cd\u7167\u7684\u9ed8\u8ba4\u5206\u8fa8\u7387\n            this.size = Size(1920, 1080)\n        }\n</code></pre></p> <p>\u4f46\u6ce8\u610f\uff0c\u6709\u4e9b\u7ec4\u5408\u662f\u4e0d\u652f\u6301\u7684 </p> <p>\u9884\u5b9a\u4e49\u7684\u7528\u4f8b\u7ec4\u5408 <pre><code>val takePhoto = customGroup(\n    UseCaseHexStatus.USE_CASE_PREVIEW,\n    UseCaseHexStatus.USE_CASE_IMAGE_CAPTURE,\n)\nval takeVideo = customGroup(\n    UseCaseHexStatus.USE_CASE_PREVIEW,\n    UseCaseHexStatus.USE_CASE_VIDEO_CAPTURE,\n)\nval imageAnalysis = customGroup(\n    UseCaseHexStatus.USE_CASE_PREVIEW,\n    UseCaseHexStatus.USE_CASE_IMAGE_ANALYZE,\n    UseCaseHexStatus.USE_CASE_IMAGE_CAPTURE,\n)\n\n/**\n * \u9664\u4e86\u9884\u89c8\u753b\u9762\u7528\u4f8b\uff0c\u4e0d\u4f7f\u7528\u5176\u4ed6\u4efb\u4f55\u7528\u4f8b\n */\nconst val onlyPreview = UseCaseHexStatus.USE_CASE_PREVIEW\n</code></pre></p> <p>\u9664\u4e86ManagerConfig\u4e2duseCaseBundle\u6307\u5b9a\u76f8\u673a\u542f\u52a8\u65f6\u7684\u9ed8\u8ba4\u7528\u4f8b\u6a21\u5f0f\uff0c\u8fd8\u53ef\u4ee5\u901a\u8c03\u7528<code>cameraXFragment</code>\u4e2d\u7684<code>setCameraUseCase</code>\u65b9\u6cd5\u6765\u52a8\u6001\u4fee\u6539\u76f8\u673a\u7684\u7528\u4f8b\u7ec4\u5408  </p> <p>\u793a\u4f8b\uff1a\u5f55\u5236\u5b8c\u89c6\u9891\u4e4b\u540e\uff0c\u5c06\u76f8\u673a\u5207\u6362\u5230\u62cd\u7167 <pre><code>    /** \u5f55\u5b8c\u89c6\u9891 */\n    override fun onVideoRecorded(saveFileData: SaveFileData?) {\n        super.onVideoRecorded(saveFileData)\n        cameraXF.setCameraUseCase(UseCaseMode.takePhoto) //\u52a8\u6001\u5207\u6362\u76f8\u673a\u7528\u4f8b\n    }\n</code></pre></p>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#_3","title":"\u6309\u4e0b\u97f3\u91cf\u952e\u62cd\u7167","text":"<p>\u5982\u679c\u4f7f\u7528\u7684\u662fCameraExampleActivity2\uff0c\u4f60\u53ef\u4ee5\u590d\u5236\u5982\u4e0b\u4ee3\u7801\u5230CameraExampleActivity2\u5b9e\u73b0\u6309\u4e0b\u97f3\u91cf\u952e\u62cd\u7167</p> <pre><code>   /**\n     * \u97f3\u91cf\u51cf\u6309\u94ae\u89e6\u53d1\u62cd\u7167\uff0c\u5982\u679c\u9700\u8981\u590d\u5236\u8fd9\u4efd\u4ee3\u7801\u5c31\u53ef\u4ee5\n     *\n     * When key down event is triggered, relay it via local broadcast so\n     * fragments can handle it\n     */\n    override fun onKeyDown(keyCode: Int, event: KeyEvent): Boolean {\n        return when (keyCode) {\n            KeyEvent.KEYCODE_VOLUME_DOWN -&gt; {\n                val intent = Intent(KEY_CAMERA_EVENT_ACTION).apply {\n                    putExtra(\n                        KEY_CAMERA_EVENT_EXTRA,\n                        keyCode\n                    )\n                }\n                LocalBroadcastManager.getInstance(this).sendBroadcast(intent)\n                true\n            }\n\n            else -&gt; super.onKeyDown(keyCode, event)\n        }\n    }\n</code></pre>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#managerconfig","title":"<code>ManagerConfig</code>\u7c7b\uff1a","text":"<pre><code>data class ManagerConfig(\n    var flashMode: Int = FlashModel.CAMERA_FLASH_OFF,\n    /**\n     * android R\u4ee5\u4e0b\u65f6\uff0c\u5728\u5c11\u6570display\u4e3anull\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbe\u7f6e\u9884\u89c8\uff0c\u62cd\u7167\u7684\u9ed8\u8ba4\u5206\u8fa8\u7387\n     */\n    var size: Size = Size(1280, 720),\n\n    /** \u6307\u5b9a\u8fd9\u6b21\u76f8\u673a\u4f7f\u7528\u7684\u7528\u4f8b\uff0c\u4f8b\u5982\u62cd\u7167\uff0c\u5f55\u50cf\uff0c\u56fe\u50cf\u8bc6\u522b\u7b49 \u67e5\u770b[UseCaseMode] */\n    var useCaseMode: Int = UseCaseMode.takePhoto,\n\n    /**\n     * \u6307\u5b9a\u56fe\u50cf\u5206\u6790\u3001\u62cd\u7167\u3001\u5f55\u5236\u7684\u65cb\u8f6c\u89d2\u5ea6,\u9ed8\u8ba4\u53ef\u80fd\u4e3a[Surface.ROTATION_0]\u3002 \u9ed8\u8ba4\u503c\u662f\u6839\u636edisplay\u7684\u65cb\u8f6c\u65b9\u5411\u800c\u5b9a\n     * \u56e0\u6b64\uff0c\u5982\u679c\u5728\u6b64\u6307\u5b9a\u503c\uff0c\u9ed8\u8ba4\u503c\u5c06\u4e0d\u4f1a\u4f7f\u7528\n     */\n    var rotation: Int = -1,\n\n    /** \u89c6\u9891\u5f55\u5236\u914d\u7f6e */\n    var recordConfig: VideoRecordConfig = VideoRecordConfig(),\n    /** \u62cd\u7167\u914d\u7f6e */\n    var imageCaptureConfig: ImageCaptureConfig = ImageCaptureConfig()\n\n)\n</code></pre>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#videorecordconfig","title":"VideoRecordConfig\u7c7b\uff1a","text":"<pre><code>data class VideoRecordConfig(\n    /**\n     * \u8bbe\u7f6e\u7528\u4e8e\u5f55\u5236\u7684\u9884\u671f\u89c6\u9891\u7f16\u7801\u6bd4\u7279\u7387\u3002\n     * \u76ee\u6807\u89c6\u9891\u7f16\u7801\u6bd4\u7279\u7387\u5c1d\u8bd5\u4f7f\u5b9e\u9645\u89c6\u9891\u7f16\u7801\u6bd4\u7279\u7387\u63a5\u8fd1\u8bf7\u6c42\u7684\u6bd4\u7279\u7387\u3002\u6bd4\u7279\u7387\u5728\u5f55\u5236\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u5f55\u5236\u7684\u573a\u666f\u3002\n     * \u5c06\u5bf9\u8bf7\u6c42\u7684\u6bd4\u7279\u7387\u8fdb\u884c\u989d\u5916\u7684\u68c0\u67e5\uff0c\u4ee5\u786e\u4fdd\u6307\u5b9a\u7684\u6bd4\u7279\u7387\u9002\u7528\uff0c\u6709\u65f6\u4f20\u9012\u7684\u6bd4\u7279\u7387\u4f1a\u5728\u5185\u90e8\u66f4\u6539\uff0c\u4ee5\u786e\u4fdd\u89c6\u9891\u5f55\u5236\u53ef\u4ee5\u6839\u636e\u5e73\u53f0\u7684\u529f\u80fd\u987a\u5229\u8fdb\u884c\u3002\n     * \u6b64 API \u4ec5\u5f71\u54cd\u89c6\u9891\u6d41\uff0c\u4e0d\u5e94\u88ab\u89c6\u4e3a\u6574\u4e2a\u5f55\u5236\u7684\u76ee\u6807\u3002\u97f3\u9891\u6d41\u7684\u6bd4\u7279\u7387\u4e0d\u53d7\u6b64 API \u7684\u5f71\u54cd\u3002\n     * \u5982\u679c\u672a\u8c03\u7528\u6b64\u65b9\u6cd5\uff08\u6b64\u5904\u4e0d\u8fdb\u884c\u4fee\u6539\uff0c\u8fd8\u662f0\u7684\u72b6\u6001\u4e0b\uff09\uff0c\u5219\u9ed8\u8ba4\u9009\u62e9\u9002\u5f53\u7684\u6bd4\u7279\u7387\u8fdb\u884c\u666e\u901a\u89c6\u9891\u5f55\u5236\u3002\u4ec5\u5f53\u9700\u8981\u81ea\u5b9a\u4e49\u6bd4\u7279\u7387\u65f6\u624d\u8c03\u7528\u6b64\u65b9\u6cd5\u3002\n     */\n    var encodingBitRate: Int = 0,\n\n    /**\n     * \u9ed8\u8ba4\u4f4d\u7f6e\u4fe1\u606f\n     * Sets a Location object representing a geographic location where the video was recorded.\n     * When use with Recorder, the geographic location is stored in udta box if the output format is MP4, and is ignored for other formats. The geographic location is stored according to ISO-6709 standard.\n     * If null, no location information will be saved with the video. Default value is null.\n     */\n    var location: Location? = null,\n\n    /**\n     * \u5f55\u5236\u65f6\u957f\n     * Sets the limit for the video duration in milliseconds.\n     * When used to generate recording with Recorder, if the specified duration limit is reached while the recording is being recorded, the recording will be finalized with VideoRecordEvent.Finalize.ERROR_DURATION_LIMIT_REACHED.\n     * If not set or set with zero, the duration will be unlimited. If set with a negative value, an IllegalArgumentException will be thrown.\n     */\n    var durationLimitMillis: Long = 0,\n\n    /**\n     * \u6587\u4ef6\u5927\u5c0f\u9650\u5236\uff0c\u4e3a0\u65e0\u9650\u5236\n     * Sets the limit for the file length in bytes.\n     * When used with Recorder to generate recording, if the specified file size limit is reached while the recording is being recorded, the recording will be finalized with VideoRecordEvent.Finalize.ERROR_FILE_SIZE_LIMIT_REACHED.\n     * If not set or set with zero, the file size will be unlimited. If set with a negative value, an IllegalArgumentException will be thrown.\n     */\n    var fileSizeLimit: DataSize = 0.kb,\n\n    /**\n     * \u89c6\u9891\u5f55\u5236\u8d28\u91cf\uff0c\u67e5\u770b[CameraRecordQuality]\uff0c\u5f53\u8bbe\u7f6e\u7684\u89c6\u9891\u62cd\u6444\u8d28\u91cf\u4e0d\u652f\u6301\u65f6\uff0c\u5c06\u4f1a\u81ea\u52a8\u5bfb\u627e\u652f\u6301\u7684\u6700\u9ad8\u8d28\u91cf\n     */\n    var quality: Int = CameraRecordQuality.HD,\n\n    /**\n     * \u955c\u50cf\u8bbe\u7f6e\n     */\n    var mirrorMode: Int = MirrorMode.MIRROR_MODE_ON_FRONT_ONLY,\n) : Parcelable\n</code></pre>"},{"location":"%E7%9B%B8%E6%9C%BA%E9%85%8D%E7%BD%AE/#imagecaptureconfig","title":"ImageCaptureConfig\u7c7b\uff1a","text":"<pre><code>data class ImageCaptureConfig(\n    /**\n     * \u6c34\u5e73\u7ffb\u8f6c\n     */\n    var horizontalMirrorMode: Int = MirrorMode.MIRROR_MODE_ON_FRONT_ONLY,\n    /**\n     * \u5782\u76f4\u7ffb\u8f6c\n     */\n    var verticalMirrorMode: Int = MirrorMode.MIRROR_MODE_ON_FRONT_ONLY,\n    /**\n     * \u9ed8\u8ba4\u4f4d\u7f6e\u4fe1\u606f\n     * Sets a Location object representing a geographic location where the video was recorded.\n     * When use with Recorder, the geographic location is stored in udta box if the output format is MP4, and is ignored for other formats. The geographic location is stored according to ISO-6709 standard.\n     * If null, no location information will be saved with the video. Default value is null.\n     */\n    var location: Location? = null,\n    /**\n     * jpeg quality\n     * @IntRange(from = 1, to = 100)\n     */\n    var jpegQuality: Int = 100,\n    /**\n     * [ImageCapture.CAPTURE_MODE_MINIMIZE_LATENCY]\uff1a\u7f29\u77ed\u56fe\u7247\u62cd\u6444\u7684\u5ef6\u8fdf\u65f6\u95f4\u3002\n     * [ImageCapture.CAPTURE_MODE_MAXIMIZE_QUALITY]\uff1a\u63d0\u9ad8\u56fe\u7247\u62cd\u6444\u7684\u56fe\u7247\u8d28\u91cf\u3002\n     * \u5982\u679c\u8bbe\u5907\u4e0d\u7b26\u5408\u6700\u4f4e\u8981\u6c42\uff0cCameraX \u4fbf\u4f1a\u56de\u9000\u5230 CAPTURE_MODE_MINIMIZE_LATENCY\u3002\n     *\n     * \u96f6\u5feb\u95e8\u5ef6\u8fdf\u4ec5\u9002\u7528\u4e8e\u56fe\u7247\u62cd\u6444\u7528\u4f8b\u3002\u65e0\u6cd5\u4e3a\u89c6\u9891\u62cd\u6444\u7528\u4f8b\u6216\u76f8\u673a\u6269\u5c55\u7a0b\u5e8f\u542f\u7528\u8be5\u529f\u80fd\u3002\n     * \u7531\u4e8e\u4f7f\u7528\u95ea\u5149\u706f\u4f1a\u589e\u52a0\u5ef6\u8fdf\u65f6\u95f4\uff0c\u56e0\u6b64\u5f53\u95ea\u5149\u706f\u5f00\u542f\u6216\u5904\u4e8e\u81ea\u52a8\u6a21\u5f0f\u65f6\uff0c\u96f6\u5feb\u95e8\u5ef6\u8fdf\u5c06\u4e0d\u8d77\u4f5c\u7528\u3002\n     */\n    var captureMode:Int =ImageCapture.CAPTURE_MODE_MINIMIZE_LATENCY\n\n) : Parcelable\n</code></pre>"}]}